---
title: "STA130 Final Project"
author: "Larry Shi, Anthony Wong, Yan Zhang, Michael Wang"
output:
  ioslides_presentation: default
  beamer_presentation: default
  widescreen: yes
subtitle: TUT 0206, and group number
editor_options:
  chunk_output_type: console
---

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# echo=FALSE will stop the code chunk from appearing in the knit document
# warning=FALSE and message=FALSE will stop R messages from appearing in the knit document
library(tidyverse)
```

# A Section Heading on its own page

## A heading that starts on a new page

This document shows a few basics on making slides with R markdown.

To produce the slides, Knit to HMTL (ioslides).

(You can also knit to PDF if you have LaTeX installed on your computer.)


---

Three dashes starts a new page when it is not started by a new header.

---

### This is a heading that doesn't start a new page

You can make text **bold** or in *italics*.

To make bullet points, start the points after a blank line:
 
- point one
- another point


---

Include some R output

```{r}
ggplot(cars, aes(x=speed, y=dist)) + geom_point()
```

---

Include the output without showing the code and R messages (which is what you want for your poster presentation).  This R code chunk also changes the size of the plot.

```{r, echo=FALSE, message=FALSE, warning=FALSE, fig.height=3}
ggplot(cars, aes(x=speed, y=dist)) + geom_point()
```

This plot shows that there is a positive relationship between distance and speed.

## Read more

There is more information on R markdown on the course website at [https://ntaback.github.io/UofT_STA130/Rmarkdownforclassreports.html](https://ntaback.github.io/UofT_STA130/Rmarkdownforclassreports.html)

For more on creating an `ioslides` presentation see [https://rmarkdown.rstudio.com/ioslides_presentation_format.html](https://rmarkdown.rstudio.com/ioslides_presentation_format.html)

# Internet Users in the World

## Introduction

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Loading all dataframes
source('scripts/load_data.R')
```

```{r, echo=FALSE, message=FALSE, warning=FALSE}
# Drawing map
world <- map_data("world") 

iu <- internetusers_data %>% rename(region = Country) 

iu$region[4] <- "USA" # to match world map data

iu <- semi_join(iu, world, by = "region") #only keep countries according to world map data

# code below is modified from 
# https://stackoverflow.com/questions/29614972/ggplot-us-state-map-colors-are-fine-polygons-jagged-r
gg <- ggplot()

gg <- gg + geom_map(
  data = world,
  map = world,
  aes(x = long, y = lat, map_id = region),
  fill = "#ffffff",
  color = "#ffffff",
  size = 0.20
)

gg <- gg + geom_map(
  data = iu,
  map = world,
  aes(fill = `INTERNET USERS`, map_id = region),
  color = "#ffffff",
  size = 0.15
)

gg <- gg + scale_fill_continuous(low = 'thistle2', high = 'darkblue',
                                 guide = 'colorbar')
gg
```

--- 

Include here a few sentences to introduce the problem and provide context. You might want to briefly summarize the data in words (what is the data and what is it used for). You can present the questions you are investigating here. 

According to the map above, there is a huge difference in the distribution of internet users around the world. 
What kind of factors are in play that create such a phenomenon? Here, we want to look at the total population of the countries, and see whether other factors like GDP, education, government, family income, and health have an impact on the density of internet users.

## Internet Users and Total Population 
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/population.R')

top_internetusers_plot
```

## Internet Users and World Region
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/world_region.R')

region_total_internetuser_graph
```

## Internet Users and World Region
```{r, echo=FALSE, message=FALSE, warning=FALSE}
region_density_internetuser_graph
```

## Internet Users and Health
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/health.R')

lifeexpect_internet_graph
```

## Internet Users and Health
```{r, echo=FALSE, message=FALSE, warning=FALSE}
lifeexpect_internet_density_graph
```

## Internet Users and Health
```{r, echo=FALSE, message=FALSE, warning=FALSE}
summary(lifeexpect_internet_model)$coefficients
summary(lifeexpect_internet_model)$r.squared
```

## Internet Users and GDP
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/gdp.R')

internetusers_gdp_graph
```

## Internet Users and GDP
```{r, echo=FALSE, message=FALSE, warning=FALSE}
internetusers_gdp_density_graph
```

## Internet Users and Education
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/education.R')

education_internet_graph
```

## Internet Users and Education
```{r, echo=FALSE, message=FALSE, warning=FALSE}
education_internet_density_graph
```

## Internet Users and Democracy
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/democracy.R')

democracy_tree
```

## Internet Users and Family Income Distributions
```{r, echo=FALSE, message=FALSE, warning=FALSE}
source('scripts/IncomeDistribution.R')

income_regression
```

## Internet Users and Family Income Distributions
```{r, echo=FALSE, message=FALSE, warning=FALSE}
mod_summary$coefficients
mod_summary$r.squared
```


## Objectives (optional)

You can list the questions of interest in complete English sentences here to highlight them. 

```{r}

```

## Data Summary (optional)

Here you can explain how you cleaned the data and created variables suitable for answering your questions. 
You can also include graphical displays that either motivated or address the questions.

We are concerened with the relationship between the internet users and various factors such as gdp, education, and democracy. We joined the population table with the factors tables by country. This helps us compare the density of internet users in a country with each of the factors. 

## Statistical Methods

From the initial analysis of the population data against internet user data, we realize that some countries with high number of internet users is due to its high total population, and this could affect how the results of the analysis with other variables. Therefore, we created a new variable named `Percentage`, which is equal to `INTERNET USERS` / `POPULATION`. This tells us the percentage of the population that uses internet, which is a lot more accurate than the total number of internet users. We also went in further and sort the `Percentage` into category of low, medium and high to allow us to create classification with ease.

GDP data were also modified in order for us to analyse the data more easily. We decided to split the GDP into 5 categories numbered from 1 to 5: Above $40000, between \$40000 and \$21000, between \$21000 and \$11500, between \$11500 and \$3700, and below \$3700. In this case, 5 is above \$40000 and 1 is below \$3700.

`Describe here what you have done to the data without presenting any results (output). If you want to indicate variables by symbols or variable names, define them here. `

## Results

`Present the main results here, in order of importance, related to the questions asked. You might use tables or graphs, or other ways to summarize your results.`

## Conclusion

  For GDP:
Developed countries (Countries have high GDP, e.g. Japan, Germany) have a larger number of internet users, and developing countries (Countries have low GDP, e.g. Ethiopia, Kenya) have a less number of internet users.

Developing countries who are making effort to be a developed country (Countries have medium GDP, e.g. Brazil, Mexico ) have the large variation of internet users domestically. 
Give your main conclusions here. Follow the order of questions you presented. 

## Acknowledgements (optional)

If you received any help from someone other than your team members you can acknowledge them. For example:   
*The authors thank Wei for providing information on additional data resources. The authors would like to thank "TA name" for helpful suggestions and comments that improved the presentation of this poster.*



